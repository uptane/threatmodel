{
  "version": "2.2.0",
  "summary": {
    "title": "OTA Basic",
    "owner": "Yasho",
    "description": "OTA update system and threats associated with it.",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 0,
        "title": "OTA Stride",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.2.0",
        "cells": [
          {
            "position": {
              "x": 489.9999999999993,
              "y": 145.0000000000001
            },
            "size": {
              "width": 560,
              "height": 340
            },
            "shape": "trust-boundary-box",
            "attrs": {
              "headerText": {
                "text": "Vehicle Trust Boundary"
              }
            },
            "zIndex": -1,
            "id": "3c4cc2b7-32b3-4327-972f-f952f90d43dd",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "Vehicle Trust Boundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 730,
              "y": 205.00000000000045
            },
            "size": {
              "width": 280,
              "height": 240
            },
            "shape": "trust-boundary-box",
            "attrs": {
              "headerText": {
                "text": "ECU Trust Boundary"
              }
            },
            "zIndex": -1,
            "id": "5d3d0293-bde6-4726-9007-8fb9138929e0",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "ECU Trust Boundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 60,
              "y": 130
            },
            "size": {
              "width": 480,
              "height": 280
            },
            "attrs": {
              "text": {
                "text": "OTA Backend"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 1,
            "id": "95e7ff0b-2ba3-43af-99ff-58fc8a659d96",
            "data": {
              "type": "tm.Process",
              "name": "OTA Backend",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "97905445-bba9-4da4-b151-3b647f2388cc",
                  "title": "New STRIDE threat",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "Provide a description for this threat",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 2,
                  "score": ""
                },
                {
                  "id": "ce3b0f93-0dfc-4b42-a5d5-fef517a6f4ec",
                  "title": "New STRIDE threat",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Provide a description for this threat",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 3,
                  "score": ""
                },
                {
                  "id": "58831378-e225-4816-8bba-a7128e2fd293",
                  "title": "New STRIDE threat",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Provide a description for this threat",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 4,
                  "score": ""
                },
                {
                  "id": "01382014-dce2-4d5a-9f6c-aa9da7df98e5",
                  "title": "New STRIDE threat",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Provide a description for this threat",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 5,
                  "score": ""
                },
                {
                  "id": "0a1d6a9c-a1ac-4819-b3a8-f6bba1495e67",
                  "title": "New STRIDE threat",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Provide a description for this threat",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 6,
                  "score": ""
                }
              ]
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "cb7cc8e7-9a0b-4eb7-8119-3e98582e3a4b",
            "source": {
              "cell": "997c45a1-99ca-4d1a-a0cf-1504e655f470"
            },
            "target": {
              "cell": "507687db-bf67-4645-8563-9f890b660c62"
            },
            "vertices": [
              {
                "x": 740,
                "y": 270
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "341c29d0-9c3e-4879-8ae8-b4a475aab6a3",
            "source": {
              "cell": "95e7ff0b-2ba3-43af-99ff-58fc8a659d96"
            },
            "target": {
              "cell": "997c45a1-99ca-4d1a-a0cf-1504e655f470"
            },
            "vertices": [
              {
                "x": 520,
                "y": 250
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "8a9c231f-8a76-4da7-8dcc-2c694895bcd7",
            "source": {
              "cell": "7d753f1c-1641-4587-b9b5-a418d5ac37bb"
            },
            "target": {
              "cell": "95e7ff0b-2ba3-43af-99ff-58fc8a659d96"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "75897410-dac4-4c25-aeae-063f88a6e680",
            "source": {
              "cell": "997c45a1-99ca-4d1a-a0cf-1504e655f470"
            },
            "target": {
              "cell": "95e7ff0b-2ba3-43af-99ff-58fc8a659d96"
            },
            "vertices": [
              {
                "x": 490,
                "y": 330
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "e63d3c47-fbe2-41fa-9e03-b421998bfa2e",
            "source": {
              "cell": "507687db-bf67-4645-8563-9f890b660c62"
            },
            "target": {
              "cell": "997c45a1-99ca-4d1a-a0cf-1504e655f470"
            }
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "5c02d034-b856-4405-b1f7-1591c7744f1a",
            "source": {
              "x": 100,
              "y": 440
            },
            "target": {
              "x": 440,
              "y": 570
            },
            "vertices": [
              {
                "x": 300,
                "y": 440
              },
              {
                "x": 440,
                "y": 510
              }
            ]
          },
          {
            "position": {
              "x": 560,
              "y": 230.00000000000023
            },
            "size": {
              "width": 140,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "Vehicle Gateway"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 11,
            "id": "997c45a1-99ca-4d1a-a0cf-1504e655f470",
            "data": {
              "type": "tm.Process",
              "name": "Vehicle Gateway",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "76041211-f93d-498b-a33e-2a9ff83c2e8c",
                  "title": "New STRIDE threat",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "Provide a description for this threat",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 1,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 765,
              "y": 240.00000000000023
            },
            "size": {
              "width": 220,
              "height": 160
            },
            "attrs": {
              "text": {
                "text": "ECU"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 12,
            "id": "507687db-bf67-4645-8563-9f890b660c62",
            "data": {
              "type": "tm.Process",
              "name": "ECU",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 230,
              "y": 485.0000000000001
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Repository Images"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "id": "7d753f1c-1641-4587-b9b5-a418d5ac37bb",
            "zIndex": 13,
            "data": {
              "type": "tm.Store",
              "name": "Repository Images",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 240,
              "y": 170.00000000000023
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Private Signing Keys"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "id": "19d02ab0-f9b3-46c7-880e-0d182c578e07",
            "zIndex": 14,
            "data": {
              "type": "tm.Store",
              "name": "Private Signing Keys",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 840,
              "y": 255.00000000000023
            },
            "size": {
              "width": 70,
              "height": 50
            },
            "attrs": {
              "text": {
                "text": "Public Signing Key"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "id": "6b8bee41-00a3-4ceb-a2fc-01838cd804ae",
            "zIndex": 15,
            "data": {
              "type": "tm.Store",
              "name": "Public Signing Key",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          }
        ]
      },
      {
        "id": 1,
        "title": "Strawman OTA Stride 2",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.2.0",
        "cells": [
          {
            "position": {
              "x": 1560,
              "y": 690
            },
            "size": {
              "width": 490,
              "height": 270
            },
            "shape": "trust-boundary-box",
            "attrs": {
              "headerText": {
                "text": "Target ECU Trust Boundary"
              }
            },
            "zIndex": -1,
            "id": "66f5bd90-33e0-4c99-8262-86633cca56f3",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "Target ECU Trust Boundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 1318,
              "y": 380.00000000000165
            },
            "size": {
              "width": 700,
              "height": 160
            },
            "shape": "trust-boundary-box",
            "attrs": {
              "headerText": {
                "text": "Gateway ECU Trust Boundary"
              }
            },
            "zIndex": -1,
            "id": "bd71625f-64bf-4a4d-80d0-83f4d7513cec",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "Gateway ECU Trust Boundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 1615,
              "y": 410
            },
            "size": {
              "width": 200,
              "height": 90
            },
            "attrs": {
              "text": {
                "text": "Firmware & Software images"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 1,
            "id": "ce5d9a9b-37c1-4ebc-b173-48503f54ce7c",
            "data": {
              "type": "tm.Actor",
              "name": "Firmware & Software images",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "b6d3f2d2-5dc6-4155-b3a0-cd1cd8313b3f",
                  "title": "Spoofing identity of legitimate source",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker may attempt to spoof the identity of the legitimate update source and trick the devices into downloading and installing firmware from a malicious source",
                  "mitigation": " Use digital signatures and certificates to verify the identity of the source before accepting and applying the update. Employing cryptographic mechanisms ensures that only firmware signed by a trusted entity is installed.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 10,
                  "score": ""
                },
                {
                  "id": "04060be9-02fe-4204-b824-dd00afc0f3c7",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "The update server could deny supplying a particular firmware version or the device could deny receiving and installing the update",
                  "mitigation": "Ensure secure logging and auditing on both the OEM's update server and the ECU installing an update. Logs should be tamper proof and include details of the firmware updates, including sources and checksums",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 21,
                  "score": "3"
                }
              ]
            }
          },
          {
            "position": {
              "x": 540,
              "y": 330
            },
            "size": {
              "width": 330,
              "height": 290
            },
            "attrs": {
              "text": {
                "text": "Update server"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 2,
            "id": "e84ecfa4-c7ab-48b5-b667-302ae6c22ec0",
            "data": {
              "type": "tm.Actor",
              "name": "Update server",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "06578a19-d642-40e0-9888-8c716e53314c",
                  "title": "Spoofing",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker may try to spoof the identity of the update server and trick devices into thinking they are communicating with the legitimate server. ",
                  "mitigation": "Use strong authentication mechanisms like TLS certificates to verify the identity of the update servers. ",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 26,
                  "score": ""
                },
                {
                  "id": "57c52d37-c6a4-40aa-bb78-2c09c3f2856b",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "The update server could deny sending a firmware version or deny having sent it.",
                  "mitigation": "Implement logging and auditing on both, the ECU and the update server. Logs should be secure and should record all information regarding the firmware update, including timestamp, firmware numbers, hashes, filenames, etc.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 27,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 376.5,
              "y": 665.000000000004
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "OEM SW & FW \ndatabase"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": "4 3"
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": "4 3"
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 4,
            "id": "d8fd8f48-b119-4bd6-bbb1-13d1d98ec3e0",
            "data": {
              "type": "tm.Store",
              "name": "OEM SW & FW \ndatabase",
              "description": "",
              "outOfScope": true,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "a5aba258-2f38-4110-b6b5-ab379e3e9a67",
                  "title": "Tampering",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Software images stored on the OEM's server can be modified, thereby compromising ALL updates to ALL vehicles under the OEM.",
                  "mitigation": "Ensure strong network and physical security practices",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 70,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 559.5000000000006,
              "y": 549.9999999999995
            },
            "size": {
              "width": 170,
              "height": 50
            },
            "attrs": {
              "text": {
                "text": "Update authentication\ncredentials"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 5,
            "id": "0e1def14-5e92-4f50-bd11-bdd691667507",
            "data": {
              "type": "tm.Actor",
              "name": "Update authentication\ncredentials",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "c24bb41f-33b8-4289-9d08-ad271d8086a8",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "Update authentication credentials could be stolen or forged to impersonate a legitimate (or older) update, tricking devices to install malicious updates.",
                  "mitigation": "Store authentication credentials securely on the device, using hardware-based security modules such as TPM (Trusted Platform Module) or HSM (Hardware Security Module). Implement multi-factor authentication where possible.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 50,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 1318,
              "y": 390
            },
            "size": {
              "width": 210,
              "height": 130
            },
            "attrs": {
              "text": {
                "text": "Gateway ECU"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 6,
            "id": "aa73d92e-d4f8-4d86-bfbf-bf8e578a1915",
            "data": {
              "type": "tm.Process",
              "name": "Gateway ECU",
              "description": "(the internet)",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "ab8a75dd-bf75-4f21-b5b3-9dcd3bcbe4e3",
                  "title": "Spoofing identity of endpoints",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "An attacker could impersonate either endpoints and trick the other into thinking they have established a connection with the legitimate endpoint and then intercept traffic between the update server and device.",
                  "mitigation": "Use mutual authentication protocols (like TLS certificates) to ensure that both the update server and the TLS client verify each others' identities before transmitting data.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 39,
                  "score": ""
                },
                {
                  "id": "24ec8fea-fc3f-4100-b484-2d7cb6166c9c",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "An attacker could intercept and alter the data being sent over the communication channel ",
                  "mitigation": "Employ end-to-end encryption using protocols like TLS to protect data integrity and confidentiality during transmission. Use cryptographic hash functions and digital signatures to ensure data has not been tampered with.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 41,
                  "score": ""
                },
                {
                  "id": "84d10396-219e-4661-94c8-79002b6ffef4",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "An attacker could read the data being transmitted over the communication channel and capture sensitive information such as firmware details, keys, personal data, etc.",
                  "mitigation": "Use strong encryption protocols like TLS to encrypt the data being transmitted. Implement access control and monitor network traffic for detecting eavesdropping/MITM scenarios.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 42,
                  "score": ""
                },
                {
                  "id": "1044ec81-c5ca-4a77-912c-777a9f263fc8",
                  "title": "New STRIDE threat",
                  "status": "NotApplicable",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "Either party could deny having sent or received any the firmware update/other data sent over the channel.",
                  "mitigation": "Mitigations such as implementation of strong logging mechanisms on both ends won't be for the communication channel, but for the two parties involved ",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 43,
                  "score": ""
                },
                {
                  "id": "eb70de39-82c2-4a66-b33e-2dce888ccf38",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacker could flood the gateway ECU with traffic, overwhelming it and preventing any legitimate flow of traffic, disrupting the update process. ",
                  "mitigation": "Implement rate limiting, traffic filtering, anomaly detection, etc. to detect and avoid DoS attacks. Use load balancing and redundancy to ensure that legitimate traffic can reach its destination. ",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 44,
                  "score": ""
                },
                {
                  "id": "bb8a5f0a-4e2c-4d2c-9c16-35f6aaab62f9",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Elevation of privilege",
                  "description": "Elevation of privilege on the network could give the attacker unauthorized access to the server or the device and alter the update process.",
                  "mitigation": "Segment network traffic and enforce strict firewall rules to limit communication paths. Use intrusion detection and prevention systems (IDPS) to monitor and respond to suspicious activities. Ensure that communication channels are secured using strong, up-to-date cryptographic protocols.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 45,
                  "score": ""
                },
                {
                  "id": "81fedb49-b5e3-4ea0-ae88-478463703a35",
                  "title": "Slow retrieval attack",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacker or someone claiming to be the vehicle can slow down network traffic, sending only enough packets to avoid timeouts. ",
                  "mitigation": "",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 81,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 1853,
              "y": 425
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Update metadata"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 8,
            "id": "726b0350-daef-47a9-a14c-9f4040a0bf0d",
            "data": {
              "type": "tm.Actor",
              "name": "Update metadata",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "d66cf89d-69c9-4c13-b42a-676b8d371beb",
            "source": {
              "x": 1815,
              "y": 455
            },
            "target": {
              "cell": "726b0350-daef-47a9-a14c-9f4040a0bf0d"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "001ee53e-9574-472d-88e7-3a8f8e3e086b",
            "source": {
              "cell": "0e1def14-5e92-4f50-bd11-bdd691667507"
            },
            "target": {
              "cell": "a64bda6e-500b-4acd-bc47-f153f2490f44"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "38e941d7-279b-4921-951b-5806b3767ed2",
            "source": {
              "cell": "cc146b71-c30a-4ffc-8559-c1e1e1dd6d29"
            },
            "target": {
              "cell": "a64bda6e-500b-4acd-bc47-f153f2490f44"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "96342b03-763e-4fbe-9188-2cf0a3bb63b9",
            "source": {
              "cell": "d8fd8f48-b119-4bd6-bbb1-13d1d98ec3e0"
            },
            "target": {
              "cell": "cc146b71-c30a-4ffc-8559-c1e1e1dd6d29"
            },
            "vertices": [
              {
                "x": 414.50000000000057,
                "y": 449.99999999999943
              },
              {
                "x": 528.0000000000006,
                "y": 369.99999999999943
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Update package",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "efe0bcc9-1216-4618-81bc-c9b620417b5c",
            "source": {
              "cell": "aa73d92e-d4f8-4d86-bfbf-bf8e578a1915"
            },
            "target": {
              "cell": "ce5d9a9b-37c1-4ebc-b173-48503f54ce7c"
            },
            "vertices": [
              {
                "x": 1540,
                "y": 455
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Device \nauthentication keys,\nupdate request",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": true,
              "protocol": "WiFi/4G/5G",
              "threats": [
                {
                  "id": "1535ff27-1822-4d9e-9091-e302df41992a",
                  "title": "Tampering with update request",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "An attacker can modify the requested updates by the vehicle and make the update server send inaccurate images back to the vehicle",
                  "mitigation": "Ensure that communication channels are encrypted using strong protocols like TLS. Implement integrity checks like digital signatures to detect any tampering upon receipt by the server.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 68,
                  "score": ""
                },
                {
                  "id": "47bca19e-ccaf-45b2-95aa-7e8a2940665f",
                  "title": "Stealing device keys",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Unauthorized access can lead to the device's keys and other credentials (like VIN) to be stolen by an attacker",
                  "mitigation": "Encrypt the communication channel with strong, standard encryption protocols like TLS.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 69,
                  "score": ""
                }
              ]
            },
            "id": "a5794a19-fede-4697-981b-4c7c4ac79969",
            "labels": [
              "Device \nauthentication keys,\nupdate request"
            ],
            "source": {
              "cell": "aa73d92e-d4f8-4d86-bfbf-bf8e578a1915"
            },
            "target": {
              "cell": "e84ecfa4-c7ab-48b5-b667-302ae6c22ec0"
            },
            "vertices": [
              {
                "x": 1080,
                "y": 550
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Distributor side \ntrust boundary",
              "description": "Tier-1 supplier OR OEM",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "797a205d-bb65-47fa-923c-e4534b9a9965",
            "labels": [
              "Distributor side \ntrust boundary"
            ],
            "source": {
              "x": 850,
              "y": 240
            },
            "target": {
              "x": 820,
              "y": 770
            },
            "vertices": [
              {
                "x": 940,
                "y": 400
              },
              {
                "x": 920,
                "y": 630
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "CAN/ETH",
              "threats": []
            },
            "id": "c51d218c-7b79-4809-8159-952780266720",
            "source": {
              "cell": "ce5d9a9b-37c1-4ebc-b173-48503f54ce7c"
            },
            "target": {
              "cell": "371bcf98-870b-4f28-8f9b-e201ac4bbcca"
            },
            "vertices": [
              {
                "x": 1780,
                "y": 520
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "CAN/ETH",
              "threats": []
            },
            "id": "114b6b51-0f34-480c-bf8b-6cf243109702",
            "source": {
              "cell": "371bcf98-870b-4f28-8f9b-e201ac4bbcca"
            },
            "target": {
              "cell": "cb818284-8eec-46a4-af8f-73de5eb08617"
            },
            "vertices": [
              {
                "x": 1920,
                "y": 664.9999999999981
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "0c79e028-a3f3-4913-bea3-298728dad07a",
            "source": {
              "cell": "cb818284-8eec-46a4-af8f-73de5eb08617"
            },
            "target": {
              "cell": "c6b2697c-440d-4b4b-b6c5-8175053e60a8"
            },
            "vertices": [
              {
                "x": 1940,
                "y": 864.9999999999981
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Vehicle Trust\nBoundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "f613fa50-d5ce-44ef-922c-896ed1f25e72",
            "labels": [
              "Vehicle Trust\nBoundary"
            ],
            "source": {
              "x": 1350,
              "y": 220
            },
            "target": {
              "x": 1550,
              "y": 980
            },
            "vertices": [
              {
                "x": 1270,
                "y": 590
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Update package",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": true,
              "protocol": "WiFi/4G/5G",
              "threats": [
                {
                  "id": "a9adc947-e9a9-4a6d-86a3-c3990f2ae7ad",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "An attacker could tamper with the information being sent over the communication channel and send potentially malicious software to the device",
                  "mitigation": "Ensure that communication channels are encrypted using strong protocols like TLS. Implement integrity checks like digital signatures to detect any tampering upon receipt by the device.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 29,
                  "score": ""
                },
                {
                  "id": "8c6bebc5-75c5-4247-84ec-1b827a18daa5",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "An attacker could intercept the data being sent over the communication channel and potentially gain access to privileged information or intellectual property. ",
                  "mitigation": "Use encryption for data at rest and in transit and implement RBAC for files on the server. ",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 31,
                  "score": ""
                },
                {
                  "id": "92d2fd7d-2eef-455d-9b6a-b69bde29145d",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacker could overload the update server with requests, making it unavailable to legitimate devices attempting to download updates",
                  "mitigation": "Implement rate limiting, traffic filtering and load balancing to measure server traffic. Monitor users to detect, flag and avoid DoS attacks",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 32,
                  "score": ""
                }
              ]
            },
            "id": "4b0d5591-6693-4e0b-82d9-bcf68b483332",
            "labels": [
              "Update package"
            ],
            "source": {
              "cell": "a64bda6e-500b-4acd-bc47-f153f2490f44"
            },
            "target": {
              "cell": "aa73d92e-d4f8-4d86-bfbf-bf8e578a1915"
            },
            "vertices": [
              {
                "x": 1110,
                "y": 380
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Update\nserver\ntrust boundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "cd10c48a-219c-4dd6-ae57-5212fce3edc5",
            "labels": [
              "Update\nserver\ntrust boundary"
            ],
            "source": {
              "x": 520,
              "y": 260
            },
            "target": {
              "x": 590,
              "y": 690
            },
            "vertices": [
              {
                "x": 480,
                "y": 550
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Update\nrequest",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "CAN/ETH",
              "threats": []
            },
            "id": "9d40497a-fd27-4ac7-9a60-d9b5065990b9",
            "labels": [
              "Update\nrequest"
            ],
            "source": {
              "cell": "66f5bd90-33e0-4c99-8262-86633cca56f3"
            },
            "target": {
              "cell": "aa73d92e-d4f8-4d86-bfbf-bf8e578a1915"
            },
            "vertices": [
              {
                "x": 1500,
                "y": 730
              },
              {
                "x": 1450,
                "y": 650
              }
            ]
          },
          {
            "position": {
              "x": 589.5000000000006,
              "y": 369.99999999999943
            },
            "size": {
              "width": 110,
              "height": 50
            },
            "attrs": {
              "text": {
                "text": "Update image"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 12,
            "id": "cc146b71-c30a-4ffc-8559-c1e1e1dd6d29",
            "data": {
              "type": "tm.Actor",
              "name": "Update image",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 760.0000000000006,
              "y": 424.99999999999943
            },
            "size": {
              "width": 90,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Packaging"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 13,
            "id": "a64bda6e-500b-4acd-bc47-f153f2490f44",
            "data": {
              "type": "tm.Process",
              "name": "Packaging",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "bfed034f-b987-4512-bc0a-fa681a89d18c",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Unauthorized access to alter the items to package will lead to potentially malicious/harmful items getting packaged as part of the update payload. ",
                  "mitigation": "Verify cryptographic hashes of each item to pack before packaging them. ",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 52,
                  "score": ""
                },
                {
                  "id": "68fb2f86-b20d-4da0-b7a8-58c373b1af87",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Unauthorized parties may be able to read the update to be packaged, leading to loss of sensitive information or intellectual property. ",
                  "mitigation": "Encrypt all packages to be packaged, and then the final package. Implement RBAC and monitor the network for any anomalies. ",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 53,
                  "score": ""
                },
                {
                  "id": "01ad02e7-1ee2-40a3-9293-fc028c65f1e8",
                  "title": "DoS",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Packaging service may be overburdened by creation of a large number of processes, causing it to prevent packaging the required items to be shipped. ",
                  "mitigation": "Implement redundancy of packaging service to ensure it is up in case of DoS. Implement network monitoring and rate limiting to detect and prevent attacks. ",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 59,
                  "score": ""
                },
                {
                  "id": "abeb54f4-48dc-4a23-a519-ac946d30cdf4",
                  "title": "endless data attack",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Send ECU a large amount of data and flood its memory, possibly causing the ECU to fail to operate",
                  "mitigation": "",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 88,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 1829,
              "y": 559.9999999999995
            },
            "size": {
              "width": 100,
              "height": 90
            },
            "attrs": {
              "text": {
                "text": "Image\ndistribution"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 14,
            "id": "371bcf98-870b-4f28-8f9b-e201ac4bbcca",
            "data": {
              "type": "tm.Process",
              "name": "Image\ndistribution",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "The only way this software can be accessed is with physical access to the vehicle, this making it out of scope.",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "c344927b-9689-471d-a422-46f24c7e58cb",
                  "title": "Freeze attack",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacker may alter the functioning of the distribution software (if present on gateway ECU or through an update for the image distribution software) to send properly signed, but old update bundle to the ECUs, even if newer updates exist",
                  "mitigation": "",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 82,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 1929,
              "y": 734.9999999999981
            },
            "size": {
              "width": 100,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Rewrite\nSW image"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 15,
            "id": "cb818284-8eec-46a4-af8f-73de5eb08617",
            "data": {
              "type": "tm.Process",
              "name": "Rewrite\nSW image",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 1768,
              "y": 848.9999999999981
            },
            "size": {
              "width": 100,
              "height": 90
            },
            "attrs": {
              "text": {
                "text": "Software\nImage"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 16,
            "id": "c6b2697c-440d-4b4b-b6c5-8175053e60a8",
            "data": {
              "type": "tm.Process",
              "name": "Software\nImage",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "6c547108-bd1c-4920-8e5b-d6ed02a11897",
                  "title": "Arbitrary software attack",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Elevation of privilege",
                  "description": "A malicious software bundle can cause an ECU to run arbitrary code of the attacker's choice",
                  "mitigation": "",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 77,
                  "score": ""
                },
                {
                  "id": "32b49c37-aaed-48ef-9c89-91eb41292202",
                  "title": "Rollback attack",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "Deny the ECU of the latest update by causing it to install a previously valid software",
                  "mitigation": "",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 78,
                  "score": ""
                },
                {
                  "id": "54cca2dd-6290-48a5-9f2e-f9e8edc27821",
                  "title": "Mix-and-Match attack",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacker can install a malicious software bundle in which some of the packages do not interoperate properly, by installing mismatched packages. ",
                  "mitigation": "",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 80,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 1578,
              "y": 734.9999999999981
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Device authentication\ncredentials (keys)"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 17,
            "id": "7251a67e-b75e-49ac-b64e-98294eb06191",
            "data": {
              "type": "tm.Store",
              "name": "Device authentication\ncredentials (keys)",
              "description": "should be on an HSM or TPM",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "c6ec14c1-a811-4ffb-b59b-686bf81890a9",
                  "title": "Key leak",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "An attacker could steal the ECU's authentication credentials and use them to impersonate a legitimate device. ",
                  "mitigation": "Store authentication credentials on a hardware-based security enclave like an HSM or TPM. ",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 83,
                  "score": ""
                },
                {
                  "id": "83ee79c4-739e-48ec-a135-9a1898f3e91d",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "An attacker may try to alter device's authentication credentials, giving them access to redirect updates and gain unauthorized access to sensitive data",
                  "mitigation": "Use cryptographic techniques to protect the integrity of credentials. Implement effective access control to prevent unauthorized modification",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 84,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 1769.5,
              "y": 734.9999999999981
            },
            "size": {
              "width": 140,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "User data"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 18,
            "id": "a67ca28f-21b8-487e-ab34-c9b655ee39b2",
            "data": {
              "type": "tm.Store",
              "name": "User data",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "e7924f14-6699-4555-81df-37e2142e6384",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "An attacker could modify user data by exploiting vulnerabilities in the system, leading to data corruption and possible unavailability of the vehicle's functioning.",
                  "mitigation": "Use integrity checks such as cryptographic hashes to detect unauthorized changes to the data. Implement secure storage solutions",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 85,
                  "score": ""
                },
                {
                  "id": "052b3e03-1476-4b85-befa-396568297dd8",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Unauthorized access to user data can lead to leaking of sensitive information such as personal details, affecting the user's privacy.",
                  "mitigation": "Encrypt user data at rest and in transit to protect it from unauthorized changes. Implement effective access control mechanisms for this store.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 86,
                  "score": ""
                },
                {
                  "id": "e347c1ed-48b7-48f5-a8c3-0b64247bd62a",
                  "title": "New STRIDE threat",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "An attacker could disrupt access to the user's data, making it unavailable and/or causing loss of data. This could impact the vehicle's functionality and UX",
                  "mitigation": "Implement redundancy and backup mechanisms to ensure availability of user data. ",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 87,
                  "score": ""
                }
              ]
            }
          }
        ],
        "description": "Strawman model of an OTA update system. This does not include a \"gateway ECU\". It is assumed that the update package is to be installed on the same ECU that receives the payload from the update server."
      },
      {
        "id": 2,
        "title": "Uptane OTA solution",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.2.0",
        "cells": [
          {
            "position": {
              "x": -60.000000000000796,
              "y": -69.99999999999807
            },
            "size": {
              "width": 530,
              "height": 300
            },
            "shape": "trust-boundary-box",
            "attrs": {
              "headerText": {
                "text": "Update Image trust boundary"
              }
            },
            "zIndex": -1,
            "id": "9661a28a-01ff-4bf7-aa44-a2b62c8b6d7a",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "Update Image trust boundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 210.00000000000057,
              "y": 490.00000000000114
            },
            "size": {
              "width": 450,
              "height": 130
            },
            "shape": "trust-boundary-box",
            "attrs": {
              "headerText": {
                "text": "Image Trust Boundary"
              }
            },
            "zIndex": -1,
            "id": "90207e65-3095-41d2-a441-d9705dac6cc4",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "Image Trust Boundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 1150,
              "y": -79.99999999999807
            },
            "size": {
              "width": 190,
              "height": 130
            },
            "attrs": {
              "text": {
                "text": "Primary ECU\nnetwork module"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 2,
            "id": "331fe8e3-7a22-4515-89df-4cae7704f5ce",
            "data": {
              "type": "tm.Process",
              "name": "Primary ECU\nnetwork module",
              "description": "Has public network access.\nVerifies images by checking that the hashes of the images match the hash specified by the director's target metadata",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Update request,\nVehicle version manifest",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "a68acc6f-5109-4e10-843b-3504add080c2",
            "labels": [
              "Update request,\nVehicle version manifest"
            ],
            "source": {
              "cell": "331fe8e3-7a22-4515-89df-4cae7704f5ce"
            },
            "target": {
              "cell": "c9ab3b4d-7924-4de4-b0f8-541785e33aa4"
            },
            "vertices": [
              {
                "x": 960,
                "y": -180
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "9cdb1a56-d6ce-4af1-8b63-3506fa2c166e",
            "source": {
              "cell": "5478a461-8631-4be5-888e-43011d4d0def"
            },
            "target": {
              "cell": "4e2771cd-e3e3-4d36-906a-bc1d5677c2ad"
            },
            "vertices": [
              {
                "x": 150,
                "y": -30
              },
              {
                "x": 390,
                "y": -30
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "2c1a3d15-cfe9-4cd5-a721-c46577842d61",
            "source": {
              "cell": "6ae6753f-bd10-4ac6-b54f-d6ce624b58b3"
            },
            "target": {
              "cell": "4e2771cd-e3e3-4d36-906a-bc1d5677c2ad"
            },
            "vertices": [
              {
                "x": 420,
                "y": 8
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "84e30cd3-09aa-47ce-9298-10ecc44a9568",
            "source": {
              "cell": "84f30e01-99ca-4cba-8e0f-e0ccee869959"
            },
            "target": {
              "cell": "4e2771cd-e3e3-4d36-906a-bc1d5677c2ad"
            },
            "vertices": [
              {
                "x": 440,
                "y": 140
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "7dfb51e8-f98b-4198-8342-ba7318d10e68",
            "source": {
              "cell": "888848f0-e76d-4039-8848-f1af02afc9ca"
            },
            "target": {
              "cell": "4e2771cd-e3e3-4d36-906a-bc1d5677c2ad"
            },
            "vertices": [
              {
                "x": 250,
                "y": 210
              },
              {
                "x": 440,
                "y": 180
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Update package",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "a5cdc6a8-d615-4852-958b-992d9d935767",
            "labels": [
              "Update package"
            ],
            "source": {
              "cell": "4e2771cd-e3e3-4d36-906a-bc1d5677c2ad"
            },
            "target": {
              "cell": "331fe8e3-7a22-4515-89df-4cae7704f5ce"
            },
            "vertices": [
              {
                "x": 890,
                "y": 120
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Manifest\nVerification",
              "description": "Verifies if the vehicle version manifest provided by the vehicle is accurate according to records in the inventory database",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "d1245a1c-66bd-481a-af62-a04f96251a0e",
            "labels": [
              "Manifest\nVerification"
            ],
            "source": {
              "cell": "4699e6aa-948a-4ce7-bb75-3ddaa5f5b418"
            },
            "target": {
              "cell": "c9ab3b4d-7924-4de4-b0f8-541785e33aa4"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "560c10ce-3216-434d-b34f-1e2afadf9af5",
            "source": {
              "cell": "e1e7bdf1-a5e8-4ff3-a114-104f3bf25e83"
            },
            "target": {
              "cell": "4e2771cd-e3e3-4d36-906a-bc1d5677c2ad"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "52580ab1-4b3d-4927-87aa-4794014e7219",
            "source": {
              "cell": "e030a2d3-baee-4a03-84d8-02f6489ef12e"
            },
            "target": {
              "cell": "475075af-f50a-4b65-b001-64744802f4f4"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "651b3205-bcea-4b29-b065-fe5ee7128608",
            "source": {
              "cell": "e030a2d3-baee-4a03-84d8-02f6489ef12e"
            },
            "target": {
              "cell": "307408a9-983c-400d-9378-5d369c241997"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "68bc29a1-f1c7-4d02-b537-ca998afb6f5a",
            "source": {
              "cell": "e030a2d3-baee-4a03-84d8-02f6489ef12e"
            },
            "target": {
              "cell": "1592da7c-6b5a-4696-81ec-7b940a891957"
            }
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "OEM \ntrust boundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "7d480a2b-c2af-4b7d-bab7-c261029b81f6",
            "labels": [
              "OEM \ntrust boundary"
            ],
            "source": {
              "x": 670,
              "y": -500
            },
            "target": {
              "x": 750,
              "y": 1100
            },
            "vertices": [
              {
                "x": 760,
                "y": 150
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Upload",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "ed37ed67-930c-488c-b70f-b0d8476d35fe",
            "labels": [
              "Upload"
            ],
            "source": {
              "cell": "b1ef1e76-c9ee-4402-a8af-fdb72b22ae09"
            },
            "target": {
              "cell": "1055f7e1-e736-4311-a20c-d4c4d6a9b2c5"
            },
            "vertices": [
              {
                "x": 190.00000000000068,
                "y": 633
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Images and\nassociated metadata",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "e5daa706-206f-4166-8038-9cb7b5772a85",
            "labels": [
              "Images and\nassociated metadata"
            ],
            "source": {
              "cell": "6f49d775-b193-460a-9482-d27f5e54b937"
            },
            "target": {
              "cell": "e1e7bdf1-a5e8-4ff3-a114-104f3bf25e83"
            }
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Director repo\ntrust boundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "3ec67a0a-780f-46dd-8866-70d544d7c3b5",
            "labels": [
              "Director repo\ntrust boundary"
            ],
            "source": {
              "x": -100,
              "y": -220
            },
            "target": {
              "x": 700,
              "y": 390
            },
            "vertices": [
              {
                "x": -130,
                "y": -70
              },
              {
                "x": -80,
                "y": 340
              },
              {
                "x": 440,
                "y": 390
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "61d716c4-bada-4ff3-86a2-a2cc6f0eac4c",
            "source": {
              "cell": "331fe8e3-7a22-4515-89df-4cae7704f5ce"
            },
            "target": {
              "cell": "2fe2b1e0-faa2-452d-939e-2f2b77f7752e"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "0f851e73-9bee-4ee3-83a2-8b8d77b21e80",
            "source": {
              "cell": "7c388522-fb79-4317-9bcd-50e5e66704f7"
            },
            "target": {
              "cell": "2fe2b1e0-faa2-452d-939e-2f2b77f7752e"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Signed\ninfo about \ninstalled images",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "21f71a02-9ead-4ee4-911f-8d13d9ed0410",
            "source": {
              "cell": "4b80d8bd-18d2-4057-89fa-17231d409a35"
            },
            "target": {
              "cell": "bc38d36f-2235-4225-a4ce-c68971252dcd"
            },
            "labels": [
              "Signed\ninfo about \ninstalled images"
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "e17fe5f8-4dd0-42be-8923-2895877c3dbc",
            "source": {
              "cell": "bc38d36f-2235-4225-a4ce-c68971252dcd"
            },
            "target": {
              "cell": "331fe8e3-7a22-4515-89df-4cae7704f5ce"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "4ff3f011-1af9-4ab5-829f-277764fb6ebc",
            "source": {
              "cell": "7c388522-fb79-4317-9bcd-50e5e66704f7"
            },
            "target": {
              "cell": "d52eba29-9f7a-4b56-8c87-10500090eb9f"
            }
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Vehicle trust\nBoundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "fcc714f3-6617-4c0a-950d-b4cc81897614",
            "labels": [
              "Vehicle trust\nBoundary"
            ],
            "source": {
              "x": 1180,
              "y": -230
            },
            "target": {
              "x": 1160,
              "y": 760
            },
            "vertices": [
              {
                "x": 1100,
                "y": 220
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "008c6453-407a-414d-bed0-2a096ee3201e",
            "source": {
              "cell": "2fe2b1e0-faa2-452d-939e-2f2b77f7752e"
            },
            "target": {
              "cell": "e99238c5-14b8-4540-a59f-5579a16063bc"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "3b744e92-0be1-4cf7-9258-7770b6465073",
            "source": {
              "cell": "d52eba29-9f7a-4b56-8c87-10500090eb9f"
            },
            "target": {
              "cell": "4b80d8bd-18d2-4057-89fa-17231d409a35"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Request for\nimage streaming",
              "description": "For secondary ECUs with insufficient storage, Primary SHOULD wait for a request from the Secondary to stream the new image file to it.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "40fe7fda-48fd-4f62-a66e-f775b56497be",
            "source": {
              "cell": "d52eba29-9f7a-4b56-8c87-10500090eb9f"
            },
            "target": {
              "cell": "e99238c5-14b8-4540-a59f-5579a16063bc"
            },
            "vertices": [
              {
                "x": 1490,
                "y": 330
              }
            ],
            "labels": [
              "Request for\nimage streaming"
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Image",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "8b88b03a-ca52-479e-823a-a9d83867486f",
            "source": {
              "cell": "e99238c5-14b8-4540-a59f-5579a16063bc"
            },
            "target": {
              "cell": "d52eba29-9f7a-4b56-8c87-10500090eb9f"
            },
            "vertices": [
              {
                "x": 1591.5,
                "y": 290
              }
            ],
            "labels": [
              "Image"
            ]
          },
          {
            "position": {
              "x": -50,
              "y": 130
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Timestamp\nMetadata"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 12,
            "id": "888848f0-e76d-4039-8848-f1af02afc9ca",
            "data": {
              "type": "tm.Store",
              "name": "Timestamp\nMetadata",
              "description": "Contains the filename and version number of the LATEST snapshot metadata file, along with at least one hash of the snapshot metadata file, with the hashing function used.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 152.5,
              "y": 130
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Snapshot\nMetadata"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 13,
            "id": "84f30e01-99ca-4cba-8e0f-e0ccee869959",
            "data": {
              "type": "tm.Store",
              "name": "Snapshot\nMetadata",
              "description": "Lists version numbers and filenames of all Targets metadata files. \n\nOn director for a vehicle, there will be only 1 Targets metadata file.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 152.5,
              "y": -22
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Targets metadata"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 14,
            "id": "6ae6753f-bd10-4ac6-b54f-d6ce624b58b3",
            "data": {
              "type": "tm.Store",
              "name": "Targets metadata",
              "description": "Metadata about all images to be installed on target vehicle",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": -50,
              "y": -22
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Root metadata"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 15,
            "id": "5478a461-8631-4be5-888e-43011d4d0def",
            "data": {
              "type": "tm.Store",
              "name": "Root metadata",
              "description": "root of trust for generating keys to be used by all other roles for signing metadata",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": true,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 19.99999999999983,
              "y": 460.0000000000141
            },
            "size": {
              "width": 710,
              "height": 570
            },
            "attrs": {
              "text": {
                "text": "Image repository"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 16,
            "id": "6f49d775-b193-460a-9482-d27f5e54b937",
            "data": {
              "type": "tm.Actor",
              "name": "Image repository",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 50.00000000000068,
              "y": 670
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Timestamp Metadata"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 17,
            "id": "c0dc5030-330a-4f16-9087-775e86b6e1a3",
            "data": {
              "type": "tm.Store",
              "name": "Timestamp Metadata",
              "description": "Contains filename and version number of latest snapshot metadata file, along with one or more hashes of the snapshot metadata file, with the hashing function\n",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 244.9999999999999,
              "y": 670
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Snapshot Metadata"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 18,
            "id": "fa092bfa-99cc-462b-ae40-cd958a995dd3",
            "data": {
              "type": "tm.Store",
              "name": "Snapshot Metadata",
              "description": "Contains metadata about all targets metadata files in the image repository ",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 493.0000000000007,
              "y": 528
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Targets Metadata"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 19,
            "id": "8c5cd7c8-62bd-419d-8145-9ff37985af67",
            "data": {
              "type": "tm.Store",
              "name": "Targets Metadata",
              "description": "Information about all images to be installed on ECUs. On the Image repository, there will be multiple targets metadata files",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 50.00000000000068,
              "y": 528
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Root Metadata"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 20,
            "id": "c49afc3c-84da-4c7d-af98-8423d3e23638",
            "data": {
              "type": "tm.Store",
              "name": "Root Metadata",
              "description": "root of trust for generating keys to be used by all other roles for signing metadata",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": true,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": -401,
              "y": -151.99999999999932
            },
            "size": {
              "width": 150,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Inventory Database"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 22,
            "id": "4699e6aa-948a-4ce7-bb75-3ddaa5f5b418",
            "data": {
              "type": "tm.Store",
              "name": "Inventory Database",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": -95.50000000000011,
              "y": -461.9999999999993
            },
            "size": {
              "width": 710,
              "height": 720
            },
            "attrs": {
              "text": {
                "text": "Director\nRepository"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 24,
            "id": "c9ab3b4d-7924-4de4-b0f8-541785e33aa4",
            "data": {
              "type": "tm.Actor",
              "name": "Director\nRepository",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 513,
              "y": 38
            },
            "size": {
              "width": 80,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Packaging"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 25,
            "id": "4e2771cd-e3e3-4d36-906a-bc1d5677c2ad",
            "data": {
              "type": "tm.Process",
              "name": "Packaging",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 224.25000000000068,
              "y": 528
            },
            "size": {
              "width": 240,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Software images\nfor a config"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 30,
            "id": "1055f7e1-e736-4311-a20c-d4c4d6a9b2c5",
            "data": {
              "type": "tm.Store",
              "name": "Software images\nfor a config",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": true,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 1950,
              "y": 180
            },
            "size": {
              "width": 100,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "Time source"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": "4 3"
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 31,
            "id": "7c388522-fb79-4317-9bcd-50e5e66704f7",
            "data": {
              "type": "tm.Process",
              "name": "Time source",
              "description": "A secure way for ECUs to know the time. Could be any implementation of time",
              "outOfScope": true,
              "reasonOutOfScope": "It is assumed that the source of time is secure.",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 272.5,
              "y": 50.00000000000193
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Update image"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 39,
            "id": "e1e7bdf1-a5e8-4ff3-a114-104f3bf25e83",
            "data": {
              "type": "tm.Store",
              "name": "Update image",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 469.9999999999999,
              "y": 910.9999999999987
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Root \nrole/signing keys"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 40,
            "id": "e030a2d3-baee-4a03-84d8-02f6489ef12e",
            "data": {
              "type": "tm.Actor",
              "name": "Root \nrole/signing keys",
              "description": "Root of trust for producing and distributing public keys to root, targets, snapshot and timestamp roles and  signs the root metadata",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": true,
              "threats": []
            }
          },
          {
            "position": {
              "x": 353.7499999999999,
              "y": 770
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Timestamp\nrole/signing keys"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 41,
            "id": "475075af-f50a-4b65-b001-64744802f4f4",
            "data": {
              "type": "tm.Actor",
              "name": "Timestamp\nrole/signing keys",
              "description": "Responsible for signing the timestamp metadata for the image repository",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": true,
              "threats": []
            }
          },
          {
            "position": {
              "x": 469.9999999999999,
              "y": 770
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Snapshot \nrole/signing keys"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 42,
            "id": "307408a9-983c-400d-9378-5d369c241997",
            "data": {
              "type": "tm.Actor",
              "name": "Snapshot \nrole/signing keys",
              "description": "Responsible for signing the snapshot metadata for the image repository",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": true,
              "threats": []
            }
          },
          {
            "position": {
              "x": 587.4999999999999,
              "y": 770
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Targets \nrole/signing keys"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 43,
            "id": "1592da7c-6b5a-4696-81ec-7b940a891957",
            "data": {
              "type": "tm.Actor",
              "name": "Targets \nrole/signing keys",
              "description": "Responsible for signing targets metadata for each image package",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": true,
              "threats": []
            }
          },
          {
            "position": {
              "x": 40,
              "y": -439.00000000000125
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Root \nrole/signing keys"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 44,
            "id": "cea98aef-1658-4971-acfe-1a8dfaa10381",
            "data": {
              "type": "tm.Actor",
              "name": "Root \nrole/signing keys",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": true,
              "threats": []
            }
          },
          {
            "position": {
              "x": -85.49999999999977,
              "y": -300
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Timestamp\nrole/signing keys"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 45,
            "id": "fde5b34d-7c74-427f-97f5-3bb62061b326",
            "data": {
              "type": "tm.Actor",
              "name": "Timestamp\nrole/signing keys",
              "description": "Responsible for signing the timestamp metadata for the director repository",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": true,
              "threats": []
            }
          },
          {
            "position": {
              "x": 40,
              "y": -300
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Snapshot \nrole/signing keys"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 46,
            "id": "1090cfa0-23ff-4ec0-a901-dc3350dab501",
            "data": {
              "type": "tm.Actor",
              "name": "Snapshot \nrole/signing keys",
              "description": "Responsible for signing the snapshot metadata for the director repository",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": true,
              "threats": []
            }
          },
          {
            "position": {
              "x": 163.75,
              "y": -300
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Targets \nrole/signing keys"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 47,
            "id": "a77cd259-9821-4765-8eb5-d1be62ce65c2",
            "data": {
              "type": "tm.Actor",
              "name": "Targets \nrole/signing keys",
              "description": "Responsible for signing targets metadata for each update package to send to a vehicle",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": true,
              "threats": []
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 48,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "e480264c-f32e-4fcf-9751-a2d7e1f05213",
            "source": {
              "cell": "cea98aef-1658-4971-acfe-1a8dfaa10381"
            },
            "target": {
              "cell": "fde5b34d-7c74-427f-97f5-3bb62061b326"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 49,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "6436660f-86af-4aaa-8629-79c88d5a4c1a",
            "source": {
              "cell": "cea98aef-1658-4971-acfe-1a8dfaa10381"
            },
            "target": {
              "cell": "1090cfa0-23ff-4ec0-a901-dc3350dab501"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 50,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "1a8e2bdc-4d42-496e-b59c-62efa0d25965",
            "source": {
              "cell": "cea98aef-1658-4971-acfe-1a8dfaa10381"
            },
            "target": {
              "cell": "a77cd259-9821-4765-8eb5-d1be62ce65c2"
            }
          },
          {
            "position": {
              "x": -197.99999999999977,
              "y": 610
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Software supplier"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 51,
            "id": "b1ef1e76-c9ee-4402-a8af-fdb72b22ae09",
            "data": {
              "type": "tm.Actor",
              "name": "Software supplier",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 1446,
              "y": -110
            },
            "size": {
              "width": 110,
              "height": 130
            },
            "attrs": {
              "text": {
                "text": "Full verification\nof package\nmetadata,\nimages & time"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "id": "2fe2b1e0-faa2-452d-939e-2f2b77f7752e",
            "zIndex": 52,
            "data": {
              "type": "tm.Process",
              "name": "Full verification\nof package\nmetadata,\nimages & time",
              "description": "Primary ECUs have to perform full verification",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 1250,
              "y": 400.0000000000141
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Secondary ECU\nSW and FW store"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "id": "4b80d8bd-18d2-4057-89fa-17231d409a35",
            "zIndex": 53,
            "data": {
              "type": "tm.Store",
              "name": "Secondary ECU\nSW and FW store",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 1520,
              "y": 418.0000000000001
            },
            "size": {
              "width": 130,
              "height": 110
            },
            "attrs": {
              "text": {
                "text": "Verify package\nmetadata,\nimages & time"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "id": "d52eba29-9f7a-4b56-8c87-10500090eb9f",
            "zIndex": 54,
            "data": {
              "type": "tm.Process",
              "name": "Verify package\nmetadata,\nimages & time",
              "description": "Secondary ECUs can perform partial verification",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 1250,
              "y": 90
            },
            "size": {
              "width": 100,
              "height": 110
            },
            "attrs": {
              "text": {
                "text": "Prepare\nVehicle version\nmanifest"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "id": "bc38d36f-2235-4225-a4ce-c68971252dcd",
            "zIndex": 55,
            "data": {
              "type": "tm.Process",
              "name": "Prepare\nVehicle version\nmanifest",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 1451,
              "y": 90
            },
            "size": {
              "width": 110,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Image\ndistribution"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "id": "e99238c5-14b8-4540-a59f-5579a16063bc",
            "zIndex": 56,
            "data": {
              "type": "tm.Process",
              "name": "Image\ndistribution",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 1168,
              "y": -129.99999999999844
            },
            "size": {
              "width": 530,
              "height": 360
            },
            "attrs": {
              "text": {
                "text": "Primary ECU"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "id": "09902364-274d-41b5-bd36-b0be86354044",
            "zIndex": 57,
            "data": {
              "type": "tm.Actor",
              "name": "Primary ECU",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 1203,
              "y": 378.0000000000001
            },
            "size": {
              "width": 480,
              "height": 190
            },
            "attrs": {
              "text": {
                "text": "Secondary ECU"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "id": "de435d6b-e51a-4940-9475-f8e94e6d3394",
            "zIndex": 58,
            "data": {
              "type": "tm.Actor",
              "name": "Secondary ECU",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          }
        ],
        "description": ""
      }
    ],
    "diagramTop": 3,
    "reviewer": "Phil",
    "threatTop": 89
  }
}